
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Cyber Phishing Analyzer PRO</title>
<style>
body{
  background:#0f172a;
  color:#e5e7eb;
  font-family:tahoma;
  direction:rtl;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh
}
.card{
  background:#020617;
  padding:25px;
  border-radius:16px;
  width:430px;
  box-shadow:0 0 25px rgba(56,189,248,.2)
}
textarea{
  width:100%;
  height:120px;
  background:#020617;
  border:1px solid #1e293b;
  color:white;
  padding:10px;
  border-radius:10px
}
button{
  margin-top:10px;
  width:100%;
  padding:12px;
  border:none;
  background:#38bdf8;
  color:black;
  border-radius:10px;
  cursor:pointer
}
#result{margin-top:15px;font-weight:bold}
#report{margin-top:10px;font-size:13px;color:#94a3b8;line-height:1.7}
</style>
</head>
<body>

<div class="card">
<h2>Cyber Phishing Analyzer</h2>

<textarea id="textInput" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§"></textarea>
<button onclick="analyze()">ğŸ” ØªØ­Ù„ÙŠÙ„</button>

<div id="result"></div>
<div id="report"></div>
</div>

<script>
// ===== Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ =====
const criticalWords=["Ø§ÙŠÙ‚Ø§Ù","Ù…ÙˆÙ‚ÙˆÙ","ØªØ­Ø°ÙŠØ±","Ø¹Ø§Ø¬Ù„","verify","login"];
const suspiciousWords=["otp","Ø±Ù…Ø²","password","session","token","account","Ø­Ø³Ø§Ø¨"];
const mitreMap=[
  { k:["login","ØªØ³Ø¬ÙŠÙ„"], id:"T1566.002", name:"Spearphishing Link", desc:"Ø±Ø§Ø¨Ø· Ù…Ø²ÙŠÙ Ù„Ø®Ø¯Ø§Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" },
  { k:["otp","Ø±Ù…Ø²"], id:"T1556", name:"Credential Access", desc:"Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø±Ù‚Ø© Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" },
  { k:["session","Ø¬Ù„Ø³Ø©"], id:"T1539", name:"Session Hijacking", desc:"Ø³Ø±Ù‚Ø© Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø³Ø§Ø¨" },
  { k:["Ù…ÙˆÙ‚ÙˆÙ"], id:"T1098", name:"Account Manipulation", desc:"Ø¥Ù‚Ù†Ø§Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ ØªØ­Øª Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯" }
];

const shorteners=["bit.ly","tinyurl","t.co","goo.gl"];

function extractURLs(text){
  return text.match(/https?:\/\/[^\s]+/g)||[];
}

function isIP(url){
  return /https?:\/\/\d{1,3}(\.\d{1,3}){3}/.test(url);
}

// ===== ØªØ­Ù„ÙŠÙ„ =====
function analyze(){
  let text=document.getElementById("textInput").value.toLowerCase();
  let score=0;
  let reasons=[];
  let mitreFound=[];

  // ÙƒÙ„Ù…Ø§Øª Ø­Ø±Ø¬Ø©
  criticalWords.forEach(w=>{
    if(text.includes(w)){
      score+=15;
      reasons.push("ÙƒÙ„Ù…Ø© Ø®Ø·Ø±Ø©: "+w);
    }
  });

  suspiciousWords.forEach(w=>{
    if(text.includes(w)){
      score+=10;
      reasons.push("ÙƒÙ„Ù…Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©: "+w);
    }
  });

  // MITRE
  mitreMap.forEach(m=>{
    m.k.forEach(w=>{
      if(text.includes(w)){
        mitreFound.push(`${m.id} â€” ${m.name}: ${m.desc}`);
        score+=20;
      }
    });
  });

  // Ø±ÙˆØ§Ø¨Ø·
  let urls=extractURLs(text);
  urls.forEach(url=>{
    score+=10;
    reasons.push("Ø±Ø§Ø¨Ø· Ù…ÙƒØªØ´Ù: "+url);
    if(isIP(url)){
      score+=15;
      reasons.push("Ø±Ø§Ø¨Ø· ÙŠØ³ØªØ®Ø¯Ù… IP Ø¨Ø¯Ù„ Ø¯ÙˆÙ…ÙŠÙ†");
    }
    shorteners.forEach(s=>{
      if(url.includes(s)){
        score+=15;
        reasons.push("Ø±Ø§Ø¨Ø· Ù…Ø®ØªØµØ± ÙŠØ®ÙÙŠ Ø§Ù„ÙˆØ¬Ù‡Ø©");
      }
    });
    if(!url.startsWith("https")){
      score+=10;
      reasons.push("Ø±Ø§Ø¨Ø· Ø¨Ø¯ÙˆÙ† HTTPS");
    }
  });

  // ===== Ø§Ù„Ù†ØªÙŠØ¬Ø© =====
  let percent=Math.min(score,100);
  let level="Ø¢Ù…Ù†";
  let color="lightgreen";
  if(percent>=70){level="ğŸš¨ Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø¤ÙƒØ¯";color="red";}
  else if(percent>=40){level="âš ï¸ Ù…Ø´Ø¨ÙˆÙ‡";color="orange";}

  document.getElementById("result").innerHTML=`<span style="color:${color}">Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø©: ${percent}% â€” ${level}</span>`;

  // ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
  let reportHTML="<b>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„:</b><br>";
  reasons.forEach(r=>reportHTML+="â€¢ "+r+"<br>");

  if(mitreFound.length){
    reportHTML+="<br><b>MITRE ATT&CK:</b><br>";
    mitreFound.forEach(m=>reportHTML+="â€¢ "+m+"<br>");
  }

  document.getElementById("report").innerHTML=reportHTML;
}
</script>
</body>
</html>
