
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Phishing Detector</title>

<style>
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    text-align: center;
    background: #f4f4f4;
    padding-top: 40px;
}

textarea {
    width: 380px;
    max-width: 90%;
    padding: 12px;
    font-size: 16px;
}

button {
    margin-top: 15px;
    padding: 10px 25px;
    font-size: 16px;
    cursor: pointer;
}

#result {
    margin-top: 25px;
    font-size: 20px;
    font-weight: bold;
}

#mitre {
    margin-top: 15px;
    font-size: 14px;
    color: #333;
}
</style>
</head>

<body>

<h2 id="title">ğŸ” ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ÙŠØ©</h2>

<textarea id="textInput" rows="7"
placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§"></textarea>

<br>
<button onclick="checkText()">ğŸ” ÙØ­Øµ</button>
<button onclick="toggleVoice()">ğŸ”Š Ø§Ù„ØµÙˆØª: ØªØ´ØºÙŠÙ„</button>

<div id="result"></div>
<div id="mitre"></div>

<script>
// ================= Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ØµÙˆØª =================
let voiceEnabled = true;

function speak(text) {
  if (!voiceEnabled) return;
  window.speechSynthesis.cancel();
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = "ar-SA";
  msg.rate = 1;
  window.speechSynthesis.speak(msg);
}

function toggleVoice() {
  voiceEnabled = !voiceEnabled;
  speak(voiceEnabled ? "ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª" : "ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª");
}

// ===== Ù†Ø·Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± =====
const input = document.getElementById("textInput");
const title = document.getElementById("title");
const button = document.querySelector("button");

input.addEventListener("mouseenter", () => speak("Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø·"));
input.addEventListener("focus", () => speak("Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¯Ø§Ø®Ù„ Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ"));

button.addEventListener("mouseenter", () => speak("Ø²Ø± ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©"));
button.addEventListener("focus", () => speak("Ø²Ø± ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ø¶ØºØ· Enter"));

// ================= ÙƒÙ„Ù…Ø§Øª Ø®Ø·ÙŠØ±Ø© =================
const criticalWords = [
  "Ø¥ÙŠÙ‚Ø§Ù","Ø§ÙŠÙ‚Ø§Ù","Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ","ØªØ¹Ù„ÙŠÙ‚",
  "ØªØ­Ø°ÙŠØ±","Ø¹Ø§Ø¬Ù„","Ø§Ù†Ø°Ø§Ø±","ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚",
  "verify","login","confirm","suspended"
];

// ================= ÙƒÙ„Ù…Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø© Ù…ØªÙ‚Ø¯Ù…Ø© =================
const suspiciousWords = [
  "ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙƒ","Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚","otp","token",
  "session","Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©","api key","password",
  "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„","support","Ø¯Ø¹Ù… ÙÙ†ÙŠ",
  "unusual activity","Ù†Ø´Ø§Ø· ØºÙŠØ± Ù…Ø¹ØªØ§Ø¯",
  "secure","account","Ø­Ø³Ø§Ø¨","bank","Ø¨Ù†Ùƒ"
];

// ================= Ø±ÙˆØ§Ø¨Ø· Ù…Ø®ØªØµØ±Ø© =================
const shorteners = [
  "bit.ly","tinyurl","t.co","goo.gl",
  "cutt.ly","rb.gy","ow.ly"
];

// ================= MITRE ATT&CK Mapping =================
const mitreMap = [
  { k:["login","Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ","ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"], id:"T1566.002", tactic:"Initial Access", desc:"Phishing Link" },
  { k:["verify","ØªØ­Ù‚Ù‚","ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨"], id:"T1566.002", tactic:"Initial Access", desc:"Credential Harvesting" },
  { k:["ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙƒ","update"], id:"T1566", tactic:"Initial Access", desc:"Phishing for Information" },
  { k:["otp","Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚","token"], id:"T1556", tactic:"Credential Access", desc:"Authentication Info" },
  { k:["session","Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©"], id:"T1539", tactic:"Credential Access", desc:"Session Hijacking" },
  { k:["Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ","account suspended"], id:"T1098", tactic:"Persistence", desc:"Account Manipulation" },
  { k:["support","Ø¯Ø¹Ù… ÙÙ†ÙŠ"], id:"T1566", tactic:"Initial Access", desc:"Social Engineering" },
  { k:["bit.ly","tinyurl","Ø±Ø§Ø¨Ø· Ù…Ø®ØªØµØ±"], id:"T1566", tactic:"Initial Access", desc:"Obfuscated Link" }
];

function checkText() {
  const text = document.getElementById("textInput").value.toLowerCase();
  const result = document.getElementById("result");
  const mitreDiv = document.getElementById("mitre");
  let risk = 0;
  let found = [];

  if (!text.trim()) {
    result.innerHTML = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ";
    result.style.color = "gray";
    speak("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ");
    return;
  }

  const hasLink = /https?:\/\//.test(text) || text.includes("www.");
  const hasCritical = criticalWords.some(w => text.includes(w));

  suspiciousWords.forEach(w => { if (text.includes(w)) risk++; });
  shorteners.forEach(s => { if (text.includes(s)) risk += 2; });
  if (text.includes("http://")) risk += 2;
  if (text.match(/\b\d{1,3}(\.\d{1,3}){3}\b/)) risk += 2;

  const tactics = new Set();

  mitreMap.forEach(m => {
    m.k.forEach(word => {
      if (text.includes(word)) {
        found.push(m);
        tactics.add(m.tactic);
        risk += 2;
      }
    });
  });

  if (hasLink && hasCritical || risk >= 4) {
    result.innerHTML = "ğŸš¨ Ø±Ø³Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ù„ÙŠØ© (Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)";
    result.style.color = "red";
    speak("ØªØ­Ø°ÙŠØ± Ø±Ø³Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ù„ÙŠØ© Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ");
  }
  else if (risk >= 2) {
    result.innerHTML = "âš ï¸ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©";
    result.style.color = "orange";
    speak("ØªÙ†Ø¨ÙŠÙ‡ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©");
  }
  else {
    result.innerHTML = "âœ… ØªØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø©";
    result.style.color = "green";
    speak("Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø©");
  }

  if (found.length) {
    mitreDiv.innerHTML = "<b>MITRE ATT&CK:</b><br>" +
      [...new Set(found.map(f =>
        ${f.id} â€“ ${f.tactic} (${f.desc})
      ))].join("<br>");
  } else {
    mitreDiv.innerHTML = "";
  }
}
</script>

</body>
</html>
