<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Realâ€‘Time Phishing SOC</title>

<style>
body{
background:#020617;
color:#e5e7eb;
font-family:Tahoma;
direction:rtl;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
margin:0;
background:radial-gradient(circle at top,#0f172a,#020617);
}

.card{
width:560px;
background:#020617;
border:1px solid #1e293b;
border-radius:18px;
padding:28px;
box-shadow:0 0 50px rgba(56,189,248,.35);
}

h1{color:#38bdf8;text-align:center;margin-bottom:10px}
.subtitle{color:#94a3b8;text-align:center;font-size:13px}

textarea{
width:100%;
height:160px;
background:#020617;
border:1px solid #334155;
border-radius:12px;
padding:14px;
color:white;
margin-top:18px;
font-size:15px;
}

.result{margin-top:18px;padding:15px;border-radius:12px;font-weight:bold;text-align:center}
.safe{background:#052e16;color:#22c55e}
.warn{background:#3f2a04;color:#f59e0b}
.danger{background:#3b0a0a;color:#ef4444}

.details{margin-top:12px;font-size:14px;color:#94a3b8;line-height:1.7}
</style>
</head>

<body>

<div class="card">
<h1>ğŸ›¡ SOC Phishing Detector</h1>
<div class="subtitle">ØªØ­Ù„ÙŠÙ„ ÙÙˆØ±ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… MITRE ATT&CK</div>

<textarea id="msg" placeholder="Ø§Ø¨Ø¯Ø£ Ø¨ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©..."></textarea>

<div id="result" class="result">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„...</div>
<div id="details" class="details"></div>
</div>

<script>
// ====== Ø§Ù„ØµÙˆØª ======
let lastSpeech="";
function speak(t){
if(t===lastSpeech) return;
lastSpeech=t;
speechSynthesis.cancel();
let u=new SpeechSynthesisUtterance(t);
u.lang="ar-SA";
speechSynthesis.speak(u);
}

// ====== Ø§Ù„Ø¨Ù†ÙˆÙƒ ======
const banks=[
{name:"Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ",domains:["alrajhibank.com.sa"]},
{name:"Ø§Ù„Ø£Ù‡Ù„ÙŠ",domains:["alahli.com","snb.com.sa"]},
{name:"Ø§Ù„Ø±ÙŠØ§Ø¶",domains:["riyadbank.com"]},
{name:"Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡",domains:["alinma.com"]},
{name:"stc pay",domains:["stcpay.com.sa"]},
{name:"Ù…Ø¯Ù‰",domains:["mada.com.sa"]}
];

// ===== ÙƒÙ„Ù…Ø§Øª Ø§Ø­ØªÙŠØ§Ù„ =====
const dangerWords=["Ø§ÙŠÙ‚Ø§Ù","Ù…ÙˆÙ‚ÙˆÙ","ØªØ­Ø°ÙŠØ±","verify","login","password","otp","Ø±Ù…Ø²","ØªØ­Ø¯ÙŠØ«","Ø­Ø³Ø§Ø¨"];

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ø§Ø¨Ø·
function extractURL(text){
const m=text.match(/https?://[^\s]+/);
return m?m[0]:null;
}

// ===== Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± =====
document.getElementById("msg").addEventListener("input",analyze);

function analyze(){

let text=document.getElementById("msg").value.toLowerCase();
if(!text){
document.getElementById("result").innerText="Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„...";
document.getElementById("details").innerHTML="";
return;
}

let risk=0;
let reason=[];
let mitre="";

// ÙƒÙ„Ù…Ø§Øª Ø®Ø·Ø±Ø©
dangerWords.forEach(w=>{
if(text.includes(w)){
risk+=2;
reason.push("Ø·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø©");
}
});

// Ø§Ù†ØªØ­Ø§Ù„ Ø¨Ù†Ùƒ
banks.forEach(bank=>{
if(text.includes(bank.name)){
risk+=3;
reason.push("Ø§Ù†ØªØ­Ø§Ù„ Ø¬Ù‡Ø© Ù…Ø§Ù„ÙŠØ©: "+bank.name);
mitre="T1566 Phishing";

let url=extractURL(text);
if(url){
let legit=bank.domains.some(d=>url.includes(d));
if(!legit){
risk+=3;
reason.push("Ø±Ø§Ø¨Ø· Ù…Ø²ÙŠÙ Ù„Ø§ ÙŠØªØ¨Ø¹ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø§Ù„Ø±Ø³Ù…ÙŠ");
}
}
}
});

// ===== Ø§Ù„Ù†ØªÙŠØ¬Ø© =====
let res=document.getElementById("result");
let det=document.getElementById("details");

if(risk>=6){
res.className="result danger";
res.innerText="ğŸš¨ Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø¤ÙƒØ¯";
speak("ØªØ­Ø°ÙŠØ± Ø§Ø­ØªÙŠØ§Ù„ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ");
}
else if(risk>=3){
res.className="result warn";
res.innerText="âš ï¸ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©";
speak("ØªÙ†Ø¨ÙŠÙ‡ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©");
}
else{
res.className="result safe";
res.innerText="âœ… Ø¢Ù…Ù†Ø© ØºØ§Ù„Ø¨Ø§Ù‹";
speak("Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø©");
}

det.innerHTML="<b>MITRE:</b> "+(mitre||"Ù„Ø§ ÙŠÙˆØ¬Ø¯")+
"<br><b>Ø§Ù„Ø³Ø¨Ø¨:</b><br>"+reason.join("<br>");
}

window.onload=()=>speak("ØªÙ… ØªØ´ØºÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„ÙÙˆØ±ÙŠ");
</script>

</body>
</htm
