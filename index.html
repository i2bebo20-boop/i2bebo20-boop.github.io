
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Phishing Detector</title>

<style>
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    text-align: center;
    background: #f4f4f4;
    padding-top: 40px;
}

textarea {
    width: 380px;
    max-width: 90%;
    padding: 12px;
    font-size: 16px;
}

button {
    margin-top: 15px;
    padding: 10px 25px;
    font-size: 16px;
    cursor: pointer;
}

#result {
    margin-top: 25px;
    font-size: 20px;
    font-weight: bold;
}

#mitre {
    margin-top: 15px;
    font-size: 14px;
    color: #333;
}
</style>
</head>

<body>

<h2 id="title">ğŸ” ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ÙŠØ©</h2>

<textarea
  id="textInput"
  rows="7"
  placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§"
></textarea>

<br>
<button id="scanBtn">ğŸ” ÙØ­Øµ</button>
<button id="voiceBtn">ğŸ”Š ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ</button>

<div id="result"></div>
<div id="mitre"></div>

<script>
// ================= Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµÙˆØª =================
let voiceEnabled = false;

function speak(text) {
  if (!voiceEnabled) return;
  window.speechSynthesis.cancel();
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = "ar-SA";
  msg.rate = 1;
  window.speechSynthesis.speak(msg);
}

// ===== Ø²Ø± ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª (Ù„Ø§Ø²Ù… Ø¶ØºØ·) =====
document.getElementById("voiceBtn").addEventListener("click", () => {
  voiceEnabled = true;
  const msg = new SpeechSynthesisUtterance("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ");
  msg.lang = "ar-SA";
  window.speechSynthesis.speak(msg);
});

// ================= Ù†Ø·Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± =================
const input = document.getElementById("textInput");
const title = document.getElementById("title");
const scanBtn = document.getElementById("scanBtn");

title.addEventListener("mouseenter", () =>
  speak("Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø© ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ÙŠØ©")
);

input.addEventListener("mouseenter", () =>
  speak("Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø·")
);

input.addEventListener("focus", () =>
  speak("Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¯Ø§Ø®Ù„ Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ")
);

scanBtn.addEventListener("mouseenter", () =>
  speak("Ø²Ø± ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©")
);

// ================= ÙƒÙ„Ù…Ø§Øª Ø®Ø·ÙŠØ±Ø© =================
const criticalWords = [
  "Ø¥ÙŠÙ‚Ø§Ù","Ø§ÙŠÙ‚Ø§Ù","Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ","ØªØ¹Ù„ÙŠÙ‚",
  "ØªØ­Ø°ÙŠØ±","Ø¹Ø§Ø¬Ù„","Ø§Ù†Ø°Ø§Ø±","ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚",
  "verify","login","confirm","suspended"
];

// ================= ÙƒÙ„Ù…Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø© Ù…ØªÙ‚Ø¯Ù…Ø© =================
const suspiciousWords = [
  "ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙƒ","Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚","otp","token",
  "session","Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©","api key","password",
  "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„","support","Ø¯Ø¹Ù… ÙÙ†ÙŠ",
  "unusual activity","Ù†Ø´Ø§Ø· ØºÙŠØ± Ù…Ø¹ØªØ§Ø¯",
  "secure","account","Ø­Ø³Ø§Ø¨","bank","Ø¨Ù†Ùƒ"
];

// ================= MITRE ATT&CK =================
const mitreMap = [
  { k:["login","ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"], id:"T1566.002", tactic:"Initial Access" },
  { k:["verify","ØªØ­Ù‚Ù‚","ØªØ£ÙƒÙŠØ¯"], id:"T1566.002", tactic:"Initial Access" },
  { k:["otp","Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚","token"], id:"T1556", tactic:"Credential Access" },
  { k:["session","Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©"], id:"T1539", tactic:"Credential Access" },
  { k:["Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ","account suspended"], id:"T1098", tactic:"Persistence" }
];

// ================= Ø²Ø± Ø§Ù„ÙØ­Øµ =================
document.getElementById("scanBtn").addEventListener("click", checkText);

function checkText() {
  const text = document.getElementById("textInput").value.toLowerCase();
  const result = document.getElementById("result");
  const mitreDiv = document.getElementById("mitre");

  let risk = 0;
  let found = [];

  if (!text.trim()) {
    result.innerHTML = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ";
    result.style.color = "gray";
    speak("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ");
    return;
  }

  const hasLink =
    /https?:\/\//.test(text) || text.includes("www.");
  const hasCritical =
    criticalWords.some(w => text.includes(w));

  suspiciousWords.forEach(w => {
    if (text.includes(w)) risk++;
  });

  mitreMap.forEach(m => {
    m.k.forEach(word => {
      if (text.includes(word)) {
        found.push(m.id);
        risk += 2;
      }
    });
  });

  if ((hasLink && hasCritical) || risk >= 4) {
    result.innerHTML = "ğŸš¨ Ø±Ø³Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ù„ÙŠØ© (Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)";
    result.style.color = "red";
    speak("ØªØ­Ø°ÙŠØ± Ø±Ø³Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ù„ÙŠØ© Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ");
  }
  else if (risk >= 2) {
    result.innerHTML = "âš ï¸ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©";
    result.style.color = "orange";
    speak("ØªÙ†Ø¨ÙŠÙ‡ Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©");
  }
  else {
    result.innerHTML = "âœ… ØªØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø©";
    result.style.color = "green";
    speak("Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø©");
  }

  mitreDiv.innerHTML = found.length
    ? "<b>MITRE ATT&CK:</b> " + [...new Set(found)].join(", ")
    : "";
}
</script>

</body>
</html>
