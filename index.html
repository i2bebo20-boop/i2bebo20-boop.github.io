<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Cyber Threat Analyzer</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
body{margin:0;font-family:'Cairo',sans-serif;background:#020b07;color:#00ff9c}
canvas{position:fixed;inset:0;z-index:-1}
.container{width:750px;max-width:95%;margin:60px auto;background:rgba(0,20,10,.9);padding:25px;border-radius:16px;box-shadow:0 0 30px #00ff9c55}
h1{text-align:center;text-shadow:0 0 15px #00ff9c}
textarea{width:100%;height:150px;background:#001a0d;border:1px solid #00ff9c55;border-radius:10px;padding:12px;color:#00ff9c;font-size:15px}
button{width:100%;margin-top:15px;padding:12px;background:#00ff9c;border:none;color:#002b19;font-weight:bold;border-radius:10px;cursor:pointer}
.result{margin-top:20px;padding:15px;background:#001a0d;border-radius:10px;line-height:2}
.high{color:#ff4d4d;font-weight:bold}
.medium{color:#ffd633;font-weight:bold}
.safe{color:#00ff9c;font-weight:bold}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div class="container">
<h1>ðŸ›¡ Cyber Threat Analyzer</h1>

<textarea id="msg" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù‡Ù†Ø§..."></textarea>
<button onclick="analyze()">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯</button>

<div class="result">
<p>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="result">â€”</span></p>
<p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø©: <span id="score">â€”</span></p>
<p>Ù†ÙˆØ¹ Ø§Ù„Ù‡Ø¬ÙˆÙ…: <span id="attack">â€”</span></p>
<p>MITRE ATT&CK: <span id="mitre">â€”</span></p>
<p>Ø§Ù„Ø³Ø¨Ø¨: <span id="reason">â€”</span></p>
</div>
</div>

<audio id="alarm">
<source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3">
</audio>

<script>
// ================= Matrix =================
const c=document.getElementById("matrix"),x=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight;
const letters="01",fs=14,cols=c.width/fs,drops=Array(Math.floor(cols)).fill(1);
setInterval(()=>{x.fillStyle="rgba(0,0,0,.05)";
x.fillRect(0,0,c.width,c.height);
x.fillStyle="#00ff9c";x.font=fs+"px monospace";
drops.forEach((y,i)=>{x.fillText(letters[Math.random()*2|0],i*fs,y*fs);
if(y*fs>c.height&&Math.random()>.975)drops[i]=0;drops[i]++;});},33);

// ================= Voice =================
function speak(t){
 speechSynthesis.cancel();
 let s=new SpeechSynthesisUtterance(t);
 s.lang="ar-SA";speechSynthesis.speak(s);
}

// ================= Threat Intelligence =================
const indicators=[
/* Phishing */
{type:"Phishing",mitre:"T1566",score:20,words:[
"verify","confirm","update","click","login","signin","ØªØ£ÙƒÙŠØ¯","ØªØ­Ù‚Ù‚","ØªØ­Ø¯ÙŠØ«","Ø§Ø¶ØºØ·","Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ"]},

/* Credential Harvesting */
{type:"Credential Harvesting",mitre:"T1056",score:30,words:[
"password","otp","token","pin","Ø±Ù…Ø²","ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±","Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚","one time password"]},

/* Impersonation / Brand Spoofing */
{type:"Impersonation",mitre:"T1566.002",score:20,words:[
"bank","paypal","amazon","apple","google","microsoft",
"Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ","Ø§Ù„Ø§Ù‡Ù„ÙŠ","stc","Ø³Ø§Ø¨","Ø¨Ù†Ùƒ","Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø¨Ù†ÙƒÙŠ"]},

/* Urgency / Fear */
{type:"Social Engineering",mitre:"T1204",score:15,words:[
"urgent","immediately","suspend","blocked","warning",
"Ø¹Ø§Ø¬Ù„","ØªÙ… Ø§ÙŠÙ‚Ø§Ù","ØªØ­Ø°ÙŠØ±","Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©"]},

/* Financial Fraud */
{type:"Financial Fraud",mitre:"T1110",score:25,words:[
"invoice","payment","transfer","refund","ÙØ§ØªÙˆØ±Ø©","Ø¯ÙØ¹","ØªØ­ÙˆÙŠÙ„","Ø§Ø³ØªØ±Ø¬Ø§Ø¹"]},
];

// Links & Domains
const linkPattern=/https?:\/\/|bit\.ly|tinyurl|\.ru|\.xyz|\.tk|\.cn/i;

// ================= Analysis =================
function analyze(){
 let text=msg.value.toLowerCase();
 let score=0,reasons=[],attacks=[],mitres=[];

 indicators.forEach(cat=>{
  cat.words.forEach(w=>{
   if(text.includes(w)){
    score+=cat.score;
    reasons.push(`ÙƒÙ„Ù…Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©: ${w}`);
    attacks.push(cat.type);
    mitres.push(cat.mitre);
   }
  });
 });

 if(linkPattern.test(text)){
  score+=25;
  reasons.push("Ø±Ø§Ø¨Ø· Ù…Ø´Ø¨ÙˆÙ‡ Ø£Ùˆ Ù…Ø®ØªØµØ±");
  mitres.push("T1204");
 }

 let result="Ø¢Ù…Ù†",cls="safe";
 if(score>=80){result="Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ";cls="high";alarm.play();}
 else if(score>=45){result="Ù…Ø´Ø¨ÙˆÙ‡";cls="medium";}

 document.getElementById("result").innerHTML=`<span class="${cls}">${result}</span>`;
 document.getElementById("score").innerText=score+"%";
 document.getElementById("attack").innerText=[...new Set(attacks)].join(", ")||"â€”";
 document.getElementById("mitre").innerText=[...new Set(mitres)].join(", ")||"â€”";
 document.getElementById("reason").innerText=reasons.join(" | ")||"Ù„Ø§ ÙŠÙˆØ¬Ø¯";

 speak(`Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ${result}. Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø© ${score} Ø¨Ø§Ù„Ù…Ø¦Ø©`);
}
</script>

</body>
</html>
