<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>SOC Elite Secure Analyzer</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:'Cairo',sans-serif;
background:radial-gradient(circle at top,#001a12,#000);
color:#00ffb3;
overflow:hidden;
}

/* Matrix Background */
canvas{
position:fixed;
top:0;
left:0;
z-index:-1;
opacity:0.25;
}

.container{
width:950px;
max-width:95%;
margin:40px auto;
background:rgba(0,20,15,0.9);
backdrop-filter:blur(10px);
padding:30px;
border-radius:20px;
box-shadow:0 0 40px #00ffb355;
}

h1{
text-align:center;
text-shadow:0 0 15px #00ffb3;
}

textarea{
width:100%;
height:200px;
background:#000;
border:2px solid #00ffb3;
border-radius:12px;
padding:15px;
color:#00ffb3;
font-size:17px;
resize:none;
}

.result{
margin-top:20px;
font-size:18px;
line-height:2;
}

.safe{color:#00ffb3;font-weight:bold;}
.medium{color:#ffd633;font-weight:bold;}
.danger{color:#ff4d4d;font-weight:bold;}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div class="container">
<h1>ğŸ›¡ SOC Elite Secure Analyzer</h1>
<textarea id="msg" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§ ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹"></textarea>

<div class="result">
<p>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="result">â€”</span></p>
<p id="analysis">â€”</p>
<p id="advice">â€”</p>
<p id="mitre">â€”</p>
</div>
</div>

<audio id="alarm">
<source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3">
</audio>

<script>

/* ================= MATRIX ================= */
const c=document.getElementById("matrix");
const ctx=c.getContext("2d");
c.width=window.innerWidth;
c.height=window.innerHeight;

const chars="01";
const fontSize=14;
const columns=c.width/fontSize;
const drops=Array(Math.floor(columns)).fill(1);

setInterval(()=>{
ctx.fillStyle="rgba(0,0,0,0.05)";
ctx.fillRect(0,0,c.width,c.height);
ctx.fillStyle="#00ffb3";
ctx.font=fontSize+"px monospace";
drops.forEach((y,i)=>{
ctx.fillText(chars[Math.floor(Math.random()*2)],i*fontSize,y*fontSize);
if(y*fontSize>c.height && Math.random()>0.975) drops[i]=0;
drops[i]++;
});
},35);

/* ================= VOICE ================= */
function speak(text,urgent=false){
speechSynthesis.cancel();
let s=new SpeechSynthesisUtterance(text);
s.lang="ar-SA";
s.rate=urgent?1:0.9;
s.pitch=urgent?1.1:1;
speechSynthesis.speak(s);
}

window.onload=()=>{
setTimeout(()=>{
speak("Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø¬Ø§Ù‡Ø². Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ.");
},1000);
};

/* ================= THREAT ENGINE ================= */

/* Ø¨Ù†ÙˆÙƒ Ø³Ø¹ÙˆØ¯ÙŠØ© */
const bankWords=/Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ|Ø§Ù„Ø£Ù‡Ù„ÙŠ|Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ|Ø³Ø§Ø¨|Ø³Ø§Ø¨ Ø¨Ù†Ùƒ|Ø§Ù„Ø±ÙŠØ§Ø¶|Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡|Ø§Ù„Ø¨Ù„Ø§Ø¯|Ø§Ù„Ø¬Ø²ÙŠØ±Ø©|Ø¨Ù†Ùƒ Ø§Ù„Ø±ÙŠØ§Ø¶|Ø¨Ù†Ùƒ Ø³Ø§Ø¨/i;

/* Ù…Ø­Ø§ÙØ¸ ÙˆØ®Ø¯Ù…Ø§Øª */
const walletWords=/stc pay|Ù…Ø¯Ù‰|Ø³Ø¯Ø§Ø¯|Ø¢Ø¨Ù„ Ø¨Ø§ÙŠ|apple pay|ØªØ­ÙˆÙŠÙ„ Ù…Ø§Ù„ÙŠ|ØªØ­ÙˆÙŠÙ„ Ø¹Ø§Ø¬Ù„/i;

/* Ø¬Ù‡Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ© */
const govWords=/Ø£Ø¨Ø´Ø±|Ù†ÙØ§Ø°|ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©|Ø§Ù„Ø²ÙƒØ§Ø©|Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©|Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø©|ØªÙˆÙƒÙ„Ù†Ø§/i;

/* Ø´Ø­Ù† */
const shippingWords=/Ø§Ø±Ø§Ù…ÙƒØ³|Ø³Ù…Ø³Ø§|dhl|ÙØ§ØªÙˆØ±Ø© Ø´Ø­Ù†|Ø±Ø³ÙˆÙ… Ø¬Ù…Ø±ÙƒÙŠØ©/i;

/* Ø§Ø­ØªÙŠØ§Ù„ Ø¬ÙˆØ§Ø¦Ø² */
const scamWords=/Ù…Ø¨Ø±ÙˆÙƒ|ÙØ²Øª|Ø¬Ø§Ø¦Ø²Ø©|Ø³Ø­Ø¨|Ù‡Ø¯ÙŠØ©|Ø¹Ø±Ø¶ Ø­ØµØ±ÙŠ|Ø¹Ø±Ø¶ Ø®Ø§Øµ/i;

/* Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© */
const sensitive=/password|otp|Ø±Ù…Ø²|cvv|iban|ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±|Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©|ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª|verify|login/i;

/* Ø§Ø³ØªØ¹Ø¬Ø§Ù„ */
const urgency=/Ø¹Ø§Ø¬Ù„|ÙÙˆØ±Ø§Ù‹|Ø®Ù„Ø§Ù„\s?\d+\s?Ø³Ø§Ø¹Ø©|urgent|immediately/i;

/* Ø±ÙˆØ§Ø¨Ø· */
const links=/https?:\/\/|bit\.ly|tinyurl|\.ru|\.xyz|\.tk|\.top|\.click|\.gq|\.cf|\.ml/i;

const puny=/xn--/i;

let lastText="";

function analyze(){
let text=document.getElementById("msg").value;
let t=text.toLowerCase();
if(t===lastText) return;
lastText=t;
if(t.length<5) return;

let score=0;
let mitre=[];

if(bankWords.test(t)){score+=15; mitre.push("Financial Targeting");}
if(walletWords.test(t)){score+=15;}
if(govWords.test(t)){score+=15;}
if(shippingWords.test(t)){score+=10;}
if(scamWords.test(t)){score+=15;}
if(sensitive.test(t)){score+=25; mitre.push("T1555 Credential Access");}
if(urgency.test(t)){score+=15; mitre.push("T1566 Phishing");}
if(links.test(t)){score+=25; mitre.push("T1204 User Execution");}
if(puny.test(t)){score+=20;}

if(score>100) score=100;

let result="Ø¢Ù…Ù†";
let analysis="Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¤Ø´Ø±Ø§Øª ØªÙ‡Ø¯ÙŠØ¯ ÙˆØ§Ø¶Ø­Ø©.";
let advice="ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ø¨Ø­Ø°Ø± Ø·Ø¨ÙŠØ¹ÙŠ.";
let urgent=false;

if(score>=70){
result="Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ";
analysis="ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ù…Ø¤Ø´Ø±Ø§Øª ØªØµÙŠÙ‘Ø¯ ÙˆØ§Ø­ØªÙŠØ§Ù„ Ù…ØªÙ‚Ø¯Ù…Ø© ØªØ³ØªÙ‡Ø¯Ù Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø§Ù„ÙŠØ© Ø£Ùˆ Ø´Ø®ØµÙŠØ©.";
advice="Ù„Ø§ ØªØ¶ØºØ· Ø±ÙˆØ§Ø¨Ø· ÙˆÙ„Ø§ ØªØ´Ø§Ø±Ùƒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆØ±Ø§Ù‹.";
urgent=true;
document.getElementById("alarm").play();
}
else if(score>=40){
result="Ù…Ø´Ø¨ÙˆÙ‡";
analysis="Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù†Ù…Ø§Ø· Ù‚Ø¯ ØªØ´ÙŠØ± Ø¥Ù„Ù‰ ØªØµÙŠÙ‘Ø¯ Ø£Ùˆ Ø§Ø­ØªÙŠØ§Ù„.";
advice="ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø± Ù‚Ø¨Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„.";
}

document.getElementById("result").innerHTML=result;
document.getElementById("analysis").innerText=analysis;
document.getElementById("advice").innerText=advice;
document.getElementById("mitre").innerText=mitre.join(", ")||"â€”";

speak(`Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ${result}. Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø© ${score} Ø¨Ø§Ù„Ù…Ø¦Ø©. ${analysis}. Ø§Ù„ØªÙˆØµÙŠØ©: ${advice}`,urgent);
}

/* ØªØ­Ù„ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ */
document.getElementById("msg").addEventListener("input",()=>{
setTimeout(analyze,700);
});

document.getElementById("msg").addEventListener("paste",()=>{
setTimeout(analyze,500);
});
</script>

</body>
</html>
