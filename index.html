<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Cyber Threat Analyzer</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

body{
    margin:0;
    font-family:'Cairo',sans-serif;
    background:#020b07;
    color:#00ff9c;
    overflow:hidden;
}

canvas{
    position:fixed;
    top:0;
    left:0;
    z-index:-1;
}

.container{
    width:740px;
    max-width:94%;
    margin:70px auto;
    background:rgba(0,20,10,0.9);
    padding:25px;
    border-radius:16px;
    box-shadow:0 0 35px #00ff9c66;
    backdrop-filter:blur(6px);
}

h1{
    text-align:center;
    text-shadow:0 0 15px #00ff9c;
}

textarea{
    width:100%;
    height:170px;
    background:#001a0d;
    border:1px solid #00ff9c55;
    border-radius:10px;
    padding:12px;
    color:#00ff9c;
    font-size:15px;
    resize:none;
}

button{
    width:100%;
    margin-top:15px;
    padding:13px;
    background:#00ff9c;
    border:none;
    color:#002b19;
    font-weight:bold;
    border-radius:10px;
    cursor:pointer;
}

.result{
    margin-top:20px;
    padding:15px;
    background:#001a0d;
    border-radius:10px;
    border:1px solid #00ff9c33;
    line-height:2;
}

.danger{color:#ff4d4d;font-weight:bold;}
.medium{color:#ffd633;font-weight:bold;}
.safe{color:#00ff9c;font-weight:bold;}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div class="container">
<h1>ğŸ›¡ Cyber Threat Analyzer</h1>

<textarea id="msg" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù‡Ù†Ø§..."></textarea>
<button onclick="analyze()">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯</button>

<div class="result" onmouseover="readResult()">
<p>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="result">â€”</span></p>
<p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø©: <span id="score">â€”</span></p>
<p>Ø§Ù„ÙˆØµÙ: <span id="reason">â€”</span></p>
<p>MITRE ATT&CK: <span id="mitre">â€”</span></p>
</div>
</div>

<audio id="alarm">
<source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3">
</audio>

<script>
/* Matrix */
const c=document.getElementById("matrix"),x=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight;
const chars="01",fs=14,cols=c.width/fs,drops=Array(Math.floor(cols)).fill(1);
setInterval(()=>{
x.fillStyle="rgba(0,0,0,.05)";
x.fillRect(0,0,c.width,c.height);
x.fillStyle="#00ff9c";
x.font=fs+"px monospace";
drops.forEach((y,i)=>{
x.fillText(chars[Math.random()>0.5?1:0],i*fs,y*fs);
if(y*fs>c.height&&Math.random()>0.975)drops[i]=0;
drops[i]++;
});
},33);

/* ğŸ”¥ ÙƒÙ„Ù…Ø§Øª ØªØµÙŠÙ‘Ø¯ Ø´Ø§Ù…Ù„Ø© Ø¬Ø¯Ù‹Ø§ */
const phishingWords = [
/* Ø§Ø³ØªØ¹Ø¬Ø§Ù„ ÙˆØªÙ‡Ø¯ÙŠØ¯ */
"urgent","immediately","final notice","last warning","action required",
"Ø¹Ø§Ø¬Ù„","ØªØ­Ø°ÙŠØ±","Ø¢Ø®Ø± Ø¥Ø´Ø¹Ø§Ø±","Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©","Ø³ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§Ù",

/* Ø¨Ù†ÙˆÙƒ ÙˆÙ…Ø¯ÙÙˆØ¹Ø§Øª */
"bank","account","payment","invoice","refund","transfer","iban","swift",
"otp","pin","cvv","credit card",
"Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ","Ø§Ù„Ø£Ù‡Ù„ÙŠ","Ø³Ø§Ø¨","Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡","Ø§Ù„Ø¨Ù„Ø§Ø¯","stc pay","Ù…Ø¯Ù‰","Ø§Ø¨Ù„ Ø¨Ø§ÙŠ","Ø³Ø¯Ø§Ø¯","ØªÙ…Ø§Ø±Ø§","ØªØ§Ø¨ÙŠ",

/* Ø­Ø³Ø§Ø¨Ø§Øª ÙˆÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± */
"password","username","login","verify","reset","recover","authentication",
"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±","Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…","ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„","ØªØ£ÙƒÙŠØ¯","ØªÙˆØ«ÙŠÙ‚","Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",

/* Ø¬Ù‡Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ© */
"absher","nafath","gov","moi","zakat","vat","sdaia","etimad",
"Ø£Ø¨Ø´Ø±","Ù†ÙØ§Ø°","Ø§Ù„Ø²ÙƒØ§Ø©","Ø¶Ø±ÙŠØ¨Ø©","ÙˆØ²Ø§Ø±Ø©","Ø§Ù„Ù‡ÙˆÙŠØ©","Ø§Ø¹ØªÙ…Ø§Ø¯",

/* Ø´Ø­Ù† ÙˆØªÙˆØµÙŠÙ„ */
"shipment","delivery","customs","package","tracking",
"Ø³Ù…Ø³Ø§","Ø§Ø±Ø§Ù…ÙƒØ³","dhl","fedex","ups","Ø§Ù„Ø¬Ù…Ø§Ø±Ùƒ","Ø§Ù„Ø´Ø­Ù†Ø©",

/* Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ø®ØªØµØ§Ø±Ø§Øª */
"http","https","bit.ly","tinyurl","t.co",".ru",".tk",".xyz",".zip",".exe",

/* Ø¬ÙˆØ§Ø¦Ø² ÙˆÙˆØ¸Ø§Ø¦Ù */
"winner","congratulations","reward","bonus","job offer","salary",
"Ù…Ø¨Ø±ÙˆÙƒ","ÙØ²Øª","Ø¬Ø§Ø¦Ø²Ø©","Ù…ÙƒØ§ÙØ£Ø©","Ø¹Ø±Ø¶ ÙˆØ¸ÙŠÙØ©","Ø±Ø§ØªØ¨",

/* ØªÙ‚Ù†ÙŠØ© ÙˆØ£Ù…Ù† */
"security alert","unusual activity","breach","compromised",
"ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ","Ù†Ø´Ø§Ø· ØºÙŠØ± Ù…Ø¹ØªØ§Ø¯","Ø§Ø®ØªØ±Ø§Ù‚","ØªÙ… ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨",

/* Ù‡Ù†Ø¯Ø³Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© */
"support team","security team","administrator","IT department",
"Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ","Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…","Ù‚Ø³Ù… Ø§Ù„ØªÙ‚Ù†ÙŠØ©"
];

const linkRegex=/https?:\/\/|\.ru|\.tk|\.xyz|bit\.ly|tinyurl|\.exe|\.zip/i;
let lastSpeech="";

function analyze(){
let t=document.getElementById("msg").value.toLowerCase();
let score=0,mitre=[],desc="Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‡Ø¯ÙŠØ¯ ÙˆØ§Ø¶Ø­";

phishingWords.forEach(w=>{
if(t.includes(w)){score+=6;mitre.push("T1566 Phishing");}
});

if(linkRegex.test(t)){score+=20;mitre.push("T1204 User Execution");}

let res="Ø¢Ù…Ù†",cls="safe";
if(score>=70){
res="Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ";
cls="danger";
desc="Ø±Ø³Ø§Ù„Ø© ØªØµÙŠÙ‘Ø¯ Ø§Ø­ØªÙŠØ§Ù„ÙŠ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø·ÙˆØ±Ø© ØªÙ‡Ø¯Ù Ù„Ø³Ø±Ù‚Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø©";
document.getElementById("alarm").play();
}
else if(score>=35){
res="Ù…Ø´Ø¨ÙˆÙ‡";
cls="medium";
desc="Ø±Ø³Ø§Ù„Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©";
}

document.getElementById("result").innerHTML=`<span class="${cls}">${res}</span>`;
document.getElementById("score").innerText=score+"%";
document.getElementById("reason").innerText=desc;
document.getElementById("mitre").innerText=[...new Set(mitre)].join(", ")||"â€”";

speak(`Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ${res} Ø¨Ù†Ø³Ø¨Ø© Ø®Ø·ÙˆØ±Ø© ${score} Ø¨Ø§Ù„Ù…Ø¦Ø©`);
lastSpeech=desc;
}

function speak(t){
speechSynthesis.cancel();
let s=new SpeechSynthesisUtterance(t);
s.lang="ar-SA";
speechSynthesis.speak(s);
}

function readResult(){
if(lastSpeech)speak(lastSpeech);
}
</script>

</body>
</html>
